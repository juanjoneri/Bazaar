
SELECT ID, "ROOT" FROM TREE WHERE P_ID IS NULL
UNION
SELECT DISTINCT T1.ID, "INNER" FROM TREE T1 JOIN TREE T2 ON T2.P_ID = T1.ID WHERE T1.P_ID IS NOT NULL
UNION
SELECT T1.ID, "LEAF" FROM TREE T1 LEFT JOIN TREE T2 ON T1.ID = T2.P_ID WHERE T2.P_ID IS NULL
ORDER BY ID;
